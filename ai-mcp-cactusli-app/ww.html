<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>React Table (TanStack Table) 示例</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }

        .table-container {
            overflow-x: auto;
            margin-bottom: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #333;
            cursor: pointer;
            user-select: none;
        }

        th:hover {
            background-color: #e9ecef;
        }

        tr:hover {
            background-color: #f8f9fa;
        }

        .sort-indicator {
            margin-left: 5px;
            font-size: 12px;
        }

        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }

        .pagination button {
            padding: 8px 12px;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            border-radius: 4px;
        }

        .pagination button:hover:not(:disabled) {
            background: #f0f0f0;
        }

        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .pagination select {
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .filters {
            margin-bottom: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            min-width: 200px;
        }
    </style>
</head>
<body>
<div class="container">
    <h1>React Table (TanStack Table) 示例</h1>
    <div id="root"></div>
</div>

<!-- 引入 React 和相关库 -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.development.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.development.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.4/babel.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react-table/7.8.0/react-table.development.js"></script>

<script type="text/babel">
    const { useState, useMemo } = React;

    // 模拟数据
    const sampleData = [
        { id: 1, name: '张三', age: 25, email: 'zhangsan@example.com', department: '技术部', salary: 8000 },
        { id: 2, name: '李四', age: 30, email: 'lisi@example.com', department: '市场部', salary: 7500 },
        { id: 3, name: '王五', age: 28, email: 'wangwu@example.com', department: '设计部', salary: 9000 },
        { id: 4, name: '赵六', age: 35, email: 'zhaoliu@example.com', department: '技术部', salary: 12000 },
        { id: 5, name: '钱七', age: 22, email: 'qianqi@example.com', department: '市场部', salary: 6000 },
        { id: 6, name: '孙八', age: 27, email: 'sunba@example.com', department: '人事部', salary: 7000 },
        { id: 7, name: '周九', age: 33, email: 'zhoujiu@example.com', department: '财务部', salary: 8500 },
        { id: 8, name: '吴十', age: 29, email: 'wushi@example.com', department: '技术部', salary: 9500 },
        { id: 9, name: '郑十一', age: 31, email: 'zhengshiyi@example.com', department: '设计部', salary: 8800 },
        { id: 10, name: '陈十二', age: 26, email: 'chenshier@example.com', department: '市场部', salary: 7200 }
    ];

    function DataTable() {
        const [data, setData] = useState(sampleData);
        const [globalFilter, setGlobalFilter] = useState('');

        // 定义列配置
        const columns = useMemo(() => [
            {
                Header: 'ID',
                accessor: 'id',
                width: 80,
            },
            {
                Header: '姓名',
                accessor: 'name',
                Cell: ({ value }) => <strong>{value}</strong>
            },
            {
                Header: '年龄',
                accessor: 'age',
                Cell: ({ value }) => `${value} 岁`
            },
            {
                Header: '邮箱',
                accessor: 'email',
            },
            {
                Header: '部门',
                accessor: 'department',
            },
            {
                Header: '薪资',
                accessor: 'salary',
                Cell: ({ value }) => `¥${value.toLocaleString()}`
            }
        ], []);

        // 使用 useTable hook
        const {
            getTableProps,
            getTableBodyProps,
            headerGroups,
            prepareRow,
            page,
            canPreviousPage,
            canNextPage,
            pageOptions,
            pageCount,
            gotoPage,
            nextPage,
            previousPage,
            setPageSize,
            state: { pageIndex, pageSize },
            setGlobalFilter: setTableGlobalFilter,
        } = ReactTable.useTable(
            {
                columns,
                data,
                initialState: { pageIndex: 0, pageSize: 5 },
            },
            ReactTable.useGlobalFilter,
            ReactTable.useSortBy,
            ReactTable.usePagination
        );

        // 处理全局搜索
        const handleGlobalFilterChange = (e) => {
            const value = e.target.value;
            setGlobalFilter(value);
            setTableGlobalFilter(value);
        };

        return (
            <div>
                {/* 搜索框 */}
                <div className="filters">
                    <input
                        type="text"
                        placeholder="搜索员工信息..."
                        value={globalFilter}
                        onChange={handleGlobalFilterChange}
                        className="filter-input"
                    />
                </div>

                {/* 表格 */}
                <div className="table-container">
                    <table {...getTableProps()}>
                        <thead>
                        {headerGroups.map(headerGroup => (
                            <tr {...headerGroup.getHeaderGroupProps()}>
                                {headerGroup.headers.map(column => (
                                    <th
                                        {...column.getHeaderProps(column.getSortByToggleProps())}
                                        title="点击排序"
                                    >
                                        {column.render('Header')}
                                        <span className="sort-indicator">
                                                    {column.isSorted
                                                        ? column.isSortedDesc
                                                            ? ' ↓'
                                                            : ' ↑'
                                                        : ' ↕'}
                                                </span>
                                    </th>
                                ))}
                            </tr>
                        ))}
                        </thead>
                        <tbody {...getTableBodyProps()}>
                        {page.map((row) => {
                            prepareRow(row);
                            return (
                                <tr {...row.getRowProps()}>
                                    {row.cells.map(cell => (
                                        <td {...cell.getCellProps()}>
                                            {cell.render('Cell')}
                                        </td>
                                    ))}
                                </tr>
                            );
                        })}
                        </tbody>
                    </table>
                </div>

                {/* 分页控件 */}
                <div className="pagination">
                    <button onClick={() => gotoPage(0)} disabled={!canPreviousPage}>
                        {'<<'}
                    </button>
                    <button onClick={() => previousPage()} disabled={!canPreviousPage}>
                        上一页
                    </button>
                    <span>
                            第 {pageIndex + 1} 页，共 {pageOptions.length} 页
                        </span>
                    <button onClick={() => nextPage()} disabled={!canNextPage}>
                        下一页
                    </button>
                    <button onClick={() => gotoPage(pageCount - 1)} disabled={!canNextPage}>
                        {'>>'}
                    </button>
                    <select
                        value={pageSize}
                        onChange={e => setPageSize(Number(e.target.value))}
                    >
                        {[5, 10, 20, 50].map(size => (
                            <option key={size} value={size}>
                                显示 {size} 条
                            </option>
                        ))}
                    </select>
                </div>
            </div>
        );
    }

    // 渲染应用
    ReactDOM.render(<DataTable />, document.getElementById('root'));
</script>
</body>
</html>